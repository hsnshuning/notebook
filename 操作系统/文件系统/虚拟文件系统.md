问题
    多个不同的文件系统如何共同工作在同一个操作系统？
    为何应用程序能使用统一的接口访问多个不同文件系统上的文件？
    伪文件系统是什么？为什么要有伪文件系统？

虚拟文件系统是什么？
    虚拟文件系统（Virtual File System，VFS）向下对多种文件系统进行管理和协调，以达到同一操作系统中有多种不同的文件系统的目的。VFS还统一了各种文件系统的接口，实现文件系统数据和VFS内存数据结构的互相转换。向上为应用程序提供统一的操作系统接口，程序调用统一的接口使用不同的文件系统。

VFS内存数据结构
    超级块
        包括文件系统元数据信息（类型，版本，挂载点信息），还有一个扩展信息指针，指向每个数据文件特有的扩展信息。每个文件系统都会维护一个超级块。

    内存inode
        映射文件系统inode，同时VFS为了加快操作速度维护了一个icache，通过hash表缓存inode信息，避免IO操作。根据文件系统的不同，可能除标准inode信息外，多记录一些额外信息。

    文件数据管理
        VFS的inode使用radix tree管理文件数据。radix tree每个叶子结点为一个内存页，保存文件一部数据。

    目录项
        维护文件名和inode号的映射，也有一个缓存dcache来加速处理。


VPS文件系统接口
读取数据的流程
    应用程序调用syscall
    syscall调用VFS
    VFS调用文件系统
    最后从VFS进行返回直到应用程序

路径
    应用程序open一个文件， 用路径换取一个文件描述符，调用sys_open系统调用
    VFS解析路径，找到文件，进行基本检查和权限检查。
    VFS拿到文件inode后，包装到文件描述符对应的文件结构中，返回给应用程序。

页缓存
    写缓存
        为了加速向一个块中写入的速度，采用操作系统缓存的方式减少文件系统的操作，缓存一段时间对某个块的修改，合并写入请求，同时写入。

    读缓存
        通过LRU等策略来回收内存。

    写缓冲区
    页缓存
        写缓冲区和读缓存合并叫做页缓存，在打开文件时，如果带O_DIRECT，文件系统就不会使用页缓存技术。


mmap内存映射
    通过mmap将文件的一块空间映射到内存中，在进行内存映射后，程序访问的是页缓存对应的内存页，修改也是修改的页缓存，如果需要保证修改的数据写入到存储介质，需要调用msync。操作完成后，调用munmap解除映射。

挂载点
    linux系统的VFS维护了一个统一VFS文件系统树，在操作系统启动时会有一个根文件系统FS0作为根。其他文件系统可以被挂在到这棵树上的任何一个目录下，这些目录被称为挂载点。一旦文件访问操作到达挂载点，就会跳到被挂载的文件系统的根目录处继续进行访问。

伪文件系统

