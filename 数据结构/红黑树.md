# 性质
1. 每个节点要么是黑色要么是红色。
2. 根节点是黑色。
3. 每个叶子结点(NIL)是黑色。
4. 每个红色结点的两个子节点一定都是黑色。
5. 任意一结点到每个叶子结点的路径都包含相同的黑色结点。

# 操作
## 左旋
以旋转结点为支点，右子节点变为旋转结点的父节点，右子节点的左子节点变为旋转结点的右子节点，左子节点保持不变。

## 右旋
以旋转结点为支点，左子节点变为旋转结点的父节点，左子节点的右子节点变为旋转结点的左子节点，右子节点保持不变。

## 变色
颜色由红变黑或由黑变红。

# 插入
1. 当插入一个结点时，这个节点最开始是红色的，因为红黑树是黑色结点平衡，插入黑色会破坏平衡性而必须要做自平衡。
2. 当红黑树的根节点由红转黑时红黑树的黑色结点生长一层。

插入场景
1. 红黑树为空树：直接插入结点，把结点染黑。
2. ~~插入结点的Key已存在：插入结点的Key已存在，既然红黑树总保持平衡，在插入前红黑树已经是平衡的，那么把插入结点设置为将要替代结点的颜色，再把结点的值更新就完成插入。~~
3. 插入结点的父节点为黑色：直接插入。
4. 插入结点的父节点为红色，父节点兄弟结点也是红色：
    * 插入结点为红色，从性质4可以看出祖父结点一定为黑色，这时可以把祖父-父-插入结点的黑-红-红转换为红-黑-红，也就是给祖父，父节点，父节点兄弟结点变色。
    * 结束之后看祖父结点的父节点是否为红色，如果为红色的话需要把祖父结点当作新插入结点，继续向上判断。
    * 如果祖父结点刚好为根节点，那么需要把祖父结点继续染黑，整个红黑树的黑色结点多了一层。
5. 插入结点的父节点为红色，是父节点的左子节点，父节点兄弟结点不存在或为黑色，并且父节点是祖父结点的左子节点：
    * 父节点祖父结点变色，父节点染黑，祖父结点染红。
    * 以祖父节点为支点右旋。
6. 插入结点的父节点为红色，是父节点的右子节点，父节点兄弟结点不存在或为黑色，并且父节点是祖父结点的左子节点：
    * 对父节点左旋
    * 父节点变为了插入结点，此时与场景5一样。
    * 进行场景5的处理。
7. 插入结点的父节点为红色，是父节点的右子节点，父节点兄弟结点不存在或为黑色，并且父节点是祖父结点的右子节点：
    * 父节点祖父结点变色
    * 祖父结点左旋
8. 插入结点的父节点为红色，是父节点的左子节点，父节点兄弟结点不存在或为黑色，并且父节点是祖父结点的右子节点：
    * 父节点右旋
    * 父节点作为插入结点，得到场景7。
    * 进行场景7的处理。

# 删除
当结点删除时，如果结点没有子节点可以直接删除，否则需要找其他结点来代替删除结点的位置。
替换场景
1. 无子节点：直接删除
2. 只有一个子节点：子节点顶上去
3. 有两个子节点：用右子树的最左节点替换该节点。

删除场景
1. 替换节点是红色：删除红色节点不会影响红黑树平衡。
2. 替换节点是黑色：
    1. 替换节点是其父节点的左子节点
        1. 替换节点的兄弟结点是红色
            * 兄弟结点是红色说明父节点是黑色
            * 兄弟结点父节点变色
            * 对父节点左旋，根据2.1.2.3处理
        2. 替换节点的兄弟结点是黑色
            1. 兄弟结点的右子节点是红色，左子节点任意颜色
                * 兄弟结点设为父节点颜色
                * 父节点染黑
                * 兄弟结点右子节点染黑
                * 对父节点左旋




# 参考资料
[30张图带你彻底理解红黑树](https://www.jianshu.com/p/e136ec79235c)